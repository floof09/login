{% macro list_group(
    class=false,
    contextual=false,
    list=[
        {
            text:"List Heading",
            heading:true
        },
        {
            text:"List item 1 Link",
            href:"#"
        },
        {
            text:"List item 2 Link",
            href:"#",
            list: [
                {
                    text:"Nested List item 1",
                    href:"#"
                },
                {
                    text:"Nested List item 2"
                }
            ]
        },
        {
            text:"List item 3 Non-link"
        }
    ]
) %}
    {% for item in list %}
        {% set contextual=true if item.contextual_icons %}
    {% endfor %}
    <ul class="luci-list-group{{ ' luci-list-group--contextual' if contextual }}{{ ' ' + class if class }}">
        {% for item in list %}
        <li class="luci-list-group__item{{ ' luci-list-group__item--heading' if item.heading }}">
            {% if item.heading %}
                {{ item.text }}
            {% else %}

                {% if item.contextual_icons %}
                    {{ build_list_group_contextual_element(
                        element=element,
                        item=item,
                        has_cells=has_cells
                    ) }}
                {% elif item.checkboxes %}
                    <form class="luci-form" action="#" method="post">
                        <div class="luci-form__field-group">
                            {% for checkbox in item.checkboxes %}
                                {{ form_checkbox(input_id="checkbox" + range(0, 100000) | random, checked=checkbox.checked, label=checkbox.text) }}
                            {% endfor %}
                        </div>
                    </form>
                {% else %}
                    {{ build_list_group_element(
                        element=element,
                        item=item,
                        has_cells=has_cells
                    ) }}
                {% endif %}

            {% endif %}
        </li>
        {% endfor %}
    </ul>
{% endmacro %}

{% macro build_list_group_element(item=false) %}
    {% set element = 'a' if item.href and not item.disabled else 'span' %}
    {% set has_cells = true if item.icon_name or item.pill_text %}
    <{{ element }} 
    {% if element === 'a' %}
    href="{{ item.href }}"
    {% endif %}
    class="luci-list-group__element{{ ' luci-list-group__element--link' if item.href and not item.disabled }}{{ ' luci-list-group__element--' + item.modifier if item.href and not item.disabled and item.modifier }}{{ ' luci-list-group__element--disabled' if item.disabled }}{{ ' luci-list-group__element--flex' if has_cells }}"
    >
    {% if item.icon_name %}
        <span class="luci-list-group__cell">
            {{ icon(name=item.icon_name) }}
        </span>
    {% endif %}
    {% if has_cells %}
        <span class="luci-list-group__cell luci-list-group__cell--text">
    {% endif %}
      {{ item.text }}
    {% if has_cells %}
        </span>
    {% endif %}
    {% if item.pill_text %}
        <span class="luci-list-group__cell">
            {{ pill(class=item.pill_class if item.pill_class, text=item.pill_text) }}
        </span>
    {% endif %}
    </{{ element }}>
    {% if item.list %}
      {{ list_group(list=item.list) }}
    {% endif %}
{% endmacro %}

{% macro build_list_group_contextual_element(item=false) %}
    <span class="luci-list-group__contextual-row">
        <span class="luci-list-group__contextual-cell luci-list-group__contextual-cell--text">
            {% set element = 'a' if item.href and not item.disabled else 'span' %}
            <{{ element }} 
            {% if element === 'a' %}
            href="{{ item.href }}"
            {% endif %}
            class="luci-list-group__element{{ ' luci-list-group__element--link' if item.href and not item.disabled }}{{ ' luci-list-group__element--' + item.modifier if item.href and not item.disabled and item.modifier }}{{ ' luci-list-group__element--disabled' if item.disabled }}{{ ' luci-list-group__element--flex' if has_cells }}"
            >
                {{ item.text }}
            </{{ element }}>
        </span>

        {% for contextual_icon in item.contextual_icons %}
        <span class="luci-list-group__contextual-cell">
            {% set icon_element = 'button' if not item.disabled else 'span' %}
            <{{ icon_element }} 
            {% if element === 'button' %}
            role="button"
            {% endif %}
            class="luci-list-group__element{{ ' luci-list-group__element--link' if item.href and not item.disabled }}{{ ' luci-list-group__element--' + item.modifier if item.href and not item.disabled and item.modifier }}{{ ' luci-list-group__element--disabled' if item.disabled }}{{ ' luci-list-group__element--flex' if has_cells }}"
            >
                {{ icon(name=contextual_icon.name, class="luci-icon") }}
            </{{ icon_element }}>
        </span>
        {% endfor %}
    </span>
{% endmacro %}


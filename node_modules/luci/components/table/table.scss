$luci-table-border-header-on-light: 1px solid $luci-color-neutral-61;
$luci-table-border-data-on-light: $luci-border-component-on-light;
$luci-table-box-shadow: 0 3px 0 0 rgba($luci-color-black, .04);
$luci-table-header-color-selected: $luci-color-purple-60;
$luci-table-breakpoint-sm: 660px;
$luci-table-expandable-padding-left: 38px;
$luci-table-expand-button-left: 10px;

@mixin table-header-pseudo-inline-sort-svg($caret-up-color: $luci-icon-color-disabled, $caret-down-color: $luci-icon-color-disabled) {
  // Convert hex to rgb to fix Chrome console warning
  $fill-for-caret-up-red: red($caret-up-color);
  $fill-for-caret-up-green: green($caret-up-color);
  $fill-for-caret-up-blue: blue($caret-up-color);
  $fill-for-caret-down-red: red($caret-down-color);
  $fill-for-caret-down-green: green($caret-down-color);
  $fill-for-caret-down-blue: blue($caret-down-color);

  &::after {
    background-image: url('data:image/svg+xml;utf8,
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 792 612">
        <g>
          <path fill="rgb(#{$fill-for-caret-up-red}, #{$fill-for-caret-up-green}, #{$fill-for-caret-up-blue})" d="M616.387,388.645c0,7.463-2.727,13.92-8.179,19.371L415.37,600.854c-5.453,5.451-11.909,8.178-19.37,8.178
            c-7.46,0-13.917-2.727-19.37-8.178L183.792,408.016c-5.452-5.451-8.179-11.908-8.179-19.371c0-7.461,2.727-13.916,8.179-19.369
            s11.909-8.18,19.37-8.18h385.676c7.461,0,13.918,2.727,19.37,8.18S616.387,381.184,616.387,388.645z"/>
          <path fill="rgb(#{$fill-for-caret-down-red}, #{$fill-for-caret-down-green}, #{$fill-for-caret-down-blue})" d="M616.387,223.356c0,7.46-2.727,13.917-8.179,19.369s-11.909,8.179-19.37,8.179H203.162
            c-7.461,0-13.918-2.727-19.37-8.179s-8.179-11.909-8.179-19.369c0-7.462,2.727-13.917,8.179-19.371L376.63,11.147
            c5.453-5.453,11.91-8.179,19.37-8.179c7.461,0,13.917,2.726,19.37,8.179l192.838,192.838
            C613.66,209.438,616.387,215.895,616.387,223.356z"/>
        </g>
      </svg>');
    background-repeat: no-repeat;
    content: '';
    display: inline-block;
    fill: $luci-icon-color-disabled;
    height: $luci-icon-size-xs;
    vertical-align: middle;
    width: ($luci-icon-size-xs + 2);
  }
}

.luci-table {
  margin: $luci-space-stack-lg;
  // overflow-x: auto;
  position: relative;
}

.luci-table__table {
  @include luci-font-reset;
  background: $luci-background-color-white;
  border: $luci-border-component-on-light;
  border-collapse: collapse;
  box-shadow: $luci-table-box-shadow;
  width: 100%;

  th {
    white-space: nowrap;
  }

  th,
  td {
    @include luci-source-sans-pro-bold($line-height: 1.25);
    border-bottom: $luci-table-border-header-on-light;
    color: $luci-text-color-primary-on-light;
    font-size: $luci-font-size-sm;
    padding: $luci-space-inset-md;

    &:focus {
      box-shadow: 0 0 0 2px $luci-interactive-color-focus;
      outline: 0;
      position: relative;
      z-index: 1;
    }

    &.luci-table__cell--align-center {
      text-align: center;
    }

    &.luci-table__cell--align-right {
      text-align: right;
    }

    &.luci-table__cell--align-left {
      text-align: left;
    }
  }

  &.luci-table__table--resizable-columns {

    th,
    td {
      border-left: $luci-border-component-on-light;
    }
  }

  td {
    @include luci-source-sans-pro-regular;
    border-bottom: $luci-table-border-data-on-light;
  }

  caption {
    @include luci-source-sans-pro-regular;
    color: $luci-text-color-primary-on-light;
    margin: $luci-space-stack-md;
  }

  @include luci-link($selector-name: 'a', $include-state-modifiers: false, $visited-color-change: false) {
    @include luci-font-reset();
  }
}

.luci-table__table--hover {

  tbody {

    tr {

      &:hover {
        background: $luci-background-color-light;
        cursor: pointer;
      }
    }
  }
}

th {
  &.luci-table__header-toggle {
    line-height: normal;
    padding: 0;
    text-align: center;
  }
}

.luci-table--align-right {
  th,
  td {
    text-align: right;
  }
}

.luci-table--align-center {
  th,
  td {
    text-align: center;
  }
}

.luci-table__header-select {
  width: $luci-space-inset-md;
}

.luci-table__header-cell-sort--sorting {
  cursor: pointer;
}

.luci-table__sort-label {
  @include table-header-pseudo-inline-sort-svg();
  cursor: pointer;
  position: relative;

  .luci-table__header-cell-sort--sorting & {

    &:hover {
      @include table-header-pseudo-inline-sort-svg($caret-up-color: $luci-icon-color-hover, $caret-down-color: $luci-icon-color-hover);
    }
  }

  .luci-table__header-cell-sort--sorting-descending & {
    @include table-header-pseudo-inline-sort-svg($caret-up-color: $luci-icon-color-default, $caret-down-color: $luci-icon-color-disabled);
    color: $luci-table-header-color-selected;
    cursor: pointer;
  }

  .luci-table__header-cell-sort--sorting-ascending & {
    @include table-header-pseudo-inline-sort-svg($caret-up-color: $luci-icon-color-disabled, $caret-down-color: $luci-icon-color-default);
    color: $luci-table-header-color-selected;
    cursor: pointer;
  }
}

.luci-table__header-cell-moving {
  background-color: $luci-background-color-white;
  opacity: .9;
  z-index: 2;

  th {
    background-color: $luci-background-color-light;
    cursor: grabbing !important; // sass-lint:disable-line no-important
  }
}

.luci-table__header-cell-moving-border {
  border: 1px $luci-color-neutral-61 dashed;
  z-index: 1;
}

.luci-table__header-cell-reorderable {
  cursor: grab !important; // sass-lint:disable-line no-important
}

.luci-table__header-cell-resizable {
  cursor: col-resize !important; // sass-lint:disable-line no-important
  position: relative;

  &:hover {

    &::after {
      background-color: $luci-color-neutral-61;
      bottom: 0;
      content: '';
      position: absolute;
      right: -1px;
      top: 0;
      width: 2px;
    }
  }
}

.luci-table__cell-status {
  align-items: center;
  display: inline-flex;

  .luci-icon {
    margin: $luci-space-inline-left-xxs;

    + .luci-table__cell-status-text {
      margin: 0;
    }
  }
}

.luci-table__icon-action {
  .luci-popover__button {
    .luci-icon {
      height: $luci-icon-size-sm;
      width: $luci-icon-size-sm;
    }
  }
}

.luci-icon-warning {
  fill: $luci-feedback-color-warning-primary;
}

.luci-table__cell-status-text {
  margin: $luci-space-inline-right-lg;
}

.luci-table__row--selected {
  background: $luci-background-color-light;
}

.luci-table__row--expandable {

  .luci-table__cell--indent {
    padding-left: $luci-table-expandable-padding-left;
    position: relative;
  }

  & + & {

    .luci-table__cell--indent {
      padding-left: $luci-table-expandable-padding-left + 22px;
      position: relative;

      .luci-table--expand-button {
        left: $luci-space-xl;
      }
    }
  }
}

.luci-table__row--is-expanded {
  background-color: $luci-background-color-light;

  .luci-table--expandable-rows & {
    background: $luci-background-color-light;
  }
}

.luci-table__row--child {
  display: none;

  .luci-table__row--is-expanded + & {
    display: table-row;
  }

  .luci-table__cell--indent {
    padding-left: $luci-space-xs + $luci-table-expandable-padding-left;

    .luci-table--expandable-rows & {
      padding-left: $luci-table-expandable-padding-left;
    }
  }

  & + & {

    .luci-table__cell--indent {
      padding-left: $luci-space-xl + $luci-table-expandable-padding-left;
    }
  }
}

.luci-table--expand-button {

  &.luci-button:not(.luci-button--input) {
    left: $luci-table-expand-button-left;
    min-height: 0;
    padding: 0;
    position: absolute;
    top: calc(50% - 13px);
    vertical-align: middle;
  }

  .luci-icon {
    height: $luci-icon-size-md;
    margin: 0;
    transform: rotate(-90deg);
    transition: transform .3s ease-out;
    width: $luci-icon-size-md;

    .luci-table__row--is-expanded & {
      transform: rotate(0deg);
    }
  }
}

// ==========================================================================
// Table breakpoint styles
// ==========================================================================

@media screen and (max-width: $luci-table-breakpoint-sm) {
  .luci-table {
    overflow-x: auto;
  }
}

{% macro menu(
    class=false,
    container_class="luci-container--light",
    trigger={
      type: "button",
      props: {
        text: "Button Trigger",
        class: "luci-button--secondary",
        icon_right: "expand"
      }
    },
    body_padding=true,
    action_button_text=false,
    icon_name="more"
) %}
    <div class="luci-menu{{ ' ' + class if class }}">
        {{ menu_trigger_element(trigger=trigger) }}
        <div class="luci-menu__content {{ container_class }}" role="menu" aria-hidden="true">
            <div class="luci-menu__body{{' luci-menu__body--no-padding' if not body_padding}}">
              {% if caller %}
                {{ caller() }}
              {% endif %}
            </div>
            {% if action_button_text %}
            <div class="luci-menu__action">
                {{ button(class="luci-button--primary luci-button--small", text=action_button_text if action_button_text else "Submit") }}
            </div>
            {% else %}
            {% endif %}
        </div>
    </div>
{% endmacro %}

{% macro menu_trigger_element(
    trigger={
      type: "button",
      props: {
        text: "Button Trigger",
        class: "luci-button--secondary",
        icon_right: "expand"
      }
    }
) %}
  {% set trigger_element %}
    {{ getContext(trigger.type)(
        text=trigger.props.text,
        class=trigger.props.class + ' luci-menu__trigger',
        icon_left= trigger.props.icon_left,
        icon_right= trigger.props.icon_right,
        custom_attr_array=[
          {
            name: 'aria-expanded',
            value: 'false'
          },
          {
            name: 'aria-haspopup',
            value: 'true'
          }
        ]
      ) }}
  {% endset %}

  {% if trigger.button_group.props %}
    <div class="luci-button-group">
      {{ button(text=trigger.button_group.props.text, class=trigger.button_group.props.class) }}
      {{ trigger_element | safe }}
    </div>
  {% else %}
    {{ trigger_element | safe }}
  {% endif %}
{% endmacro %}
